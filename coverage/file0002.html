<html>
  <head>
    <title>Coverage report</title>
    <link rel="stylesheet" href="style.css" />
    <meta charset="utf-8" />
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="index.html">
          <span class="dirname">lib/</span>sslconf.ml
        </a>
      </h1>
      <h2>92.86%</h2>
    </div>
    <div id="navbar">
      <span class="unvisited" style="top:95.65%"></span>
      <span class="unvisited" style="top:95.76%"></span>
      <span class="unvisited" style="top:95.87%"></span>
      <span class="unvisited" style="top:95.98%"></span>
      <span class="unvisited" style="top:96.20%"></span>
      <span class="unvisited" style="top:96.30%"></span>
      <span class="unvisited" style="top:96.41%"></span>
      <span class="unvisited" style="top:96.52%"></span>
      <span class="unvisited" style="top:96.74%"></span>
      <span class="unvisited" style="top:96.85%"></span>
      <span class="unvisited" style="top:96.96%"></span>
      <span class="unvisited" style="top:97.07%"></span>
      <span class="unvisited" style="top:97.17%"></span>
      <span class="unvisited" style="top:97.72%"></span>
      <span class="unvisited" style="top:98.15%"></span>
      <span class="unvisited" style="top:98.26%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span > </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span > </span>
<a id="L14"></a><span > </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span > </span>
<a id="L19"></a><span > </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span > </span>
<a id="L24"></a><span > </span>
<a id="L25"></a><span > </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span > </span>
<a id="L29"></a><span > </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span > </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span > </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span > </span>
<a id="L42"></a><span > </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span > </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span > </span>
<a id="L47"></a><span > </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span > </span>
<a id="L51"></a><span > </span>
<a id="L52"></a><span > </span>
<a id="L53"></a><span > </span>
<a id="L54"></a><span > </span>
<a id="L55"></a><span > </span>
<a id="L56"></a><span > </span>
<a id="L57"></a><span > </span>
<a id="L58"></a><span > </span>
<a id="L59"></a><span > </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span > </span>
<a id="L64"></a><span > </span>
<a id="L65"></a><span > </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span > </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span > </span>
<a id="L73"></a><span > </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span > </span>
<a id="L78"></a><span > </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span > </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span > </span>
<a id="L83"></a><span > </span>
<a id="L84"></a><span > </span>
<a id="L85"></a><span > </span>
<a id="L86"></a><span > </span>
<a id="L87"></a><span > </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span > </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span > </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span > </span>
<a id="L100"></a><span > </span>
<a id="L101"></a><span > </span>
<a id="L102"></a><span > </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span > </span>
<a id="L107"></a><span > </span>
<a id="L108"></a><span > </span>
<a id="L109"></a><span > </span>
<a id="L110"></a><span > </span>
<a id="L111"></a><span > </span>
<a id="L112"></a><span > </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span > </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span > </span>
<a id="L128"></a><span > </span>
<a id="L129"></a><span > </span>
<a id="L130"></a><span > </span>
<a id="L131"></a><span > </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span > </span>
<a id="L135"></a><span > </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span > </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span > </span>
<a id="L143"></a><span > </span>
<a id="L144"></a><span > </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span > </span>
<a id="L149"></a><span > </span>
<a id="L150"></a><span > </span>
<a id="L151"></a><span > </span>
<a id="L152"></a><span > </span>
<a id="L153"></a><span > </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span > </span>
<a id="L157"></a><span > </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span > </span>
<a id="L160"></a><span > </span>
<a id="L161"></a><span > </span>
<a id="L162"></a><span > </span>
<a id="L163"></a><span > </span>
<a id="L164"></a><span > </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span > </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span > </span>
<a id="L172"></a><span > </span>
<a id="L173"></a><span > </span>
<a id="L174"></a><span > </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span > </span>
<a id="L179"></a><span > </span>
<a id="L180"></a><span > </span>
<a id="L181"></a><span > </span>
<a id="L182"></a><span > </span>
<a id="L183"></a><span > </span>
<a id="L184"></a><span > </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span > </span>
<a id="L187"></a><span > </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span > </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span > </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span > </span>
<a id="L194"></a><span > </span>
<a id="L195"></a><span > </span>
<a id="L196"></a><span > </span>
<a id="L197"></a><span > </span>
<a id="L198"></a><span > </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span > </span>
<a id="L201"></a><span > </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span > </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span > </span>
<a id="L206"></a><span > </span>
<a id="L207"></a><span > </span>
<a id="L208"></a><span > </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span > </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span > </span>
<a id="L214"></a><span > </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span > </span>
<a id="L218"></a><span > </span>
<a id="L219"></a><span > </span>
<a id="L220"></a><span > </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span > </span>
<a id="L223"></a><span > </span>
<a id="L224"></a><span > </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span > </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span > </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span > </span>
<a id="L233"></a><span > </span>
<a id="L234"></a><span > </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span > </span>
<a id="L239"></a><span > </span>
<a id="L240"></a><span > </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span > </span>
<a id="L245"></a><span > </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span > </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span > </span>
<a id="L252"></a><span > </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span > </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span > </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span > </span>
<a id="L263"></a><span > </span>
<a id="L264"></a><span > </span>
<a id="L265"></a><span > </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span > </span>
<a id="L270"></a><span > </span>
<a id="L271"></a><span > </span>
<a id="L272"></a><span > </span>
<a id="L273"></a><span > </span>
<a id="L274"></a><span > </span>
<a id="L275"></a><span > </span>
<a id="L276"></a><span > </span>
<a id="L277"></a><span > </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span > </span>
<a id="L280"></a><span > </span>
<a id="L281"></a><span > </span>
<a id="L282"></a><span > </span>
<a id="L283"></a><span > </span>
<a id="L284"></a><span > </span>
<a id="L285"></a><span > </span>
<a id="L286"></a><span > </span>
<a id="L287"></a><span > </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span > </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span > </span>
<a id="L292"></a><span > </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span class="visited"> </span>
<a id="L295"></a><span class="visited"> </span>
<a id="L296"></a><span class="visited"> </span>
<a id="L297"></a><span class="visited"> </span>
<a id="L298"></a><span class="visited"> </span>
<a id="L299"></a><span class="visited"> </span>
<a id="L300"></a><span > </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span class="visited"> </span>
<a id="L304"></a><span > </span>
<a id="L305"></a><span > </span>
<a id="L306"></a><span > </span>
<a id="L307"></a><span class="visited"> </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span > </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span > </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span > </span>
<a id="L315"></a><span class="visited"> </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span > </span>
<a id="L318"></a><span class="visited"> </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span class="visited"> </span>
<a id="L321"></a><span class="visited"> </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span class="visited"> </span>
<a id="L325"></a><span class="visited"> </span>
<a id="L326"></a><span class="visited"> </span>
<a id="L327"></a><span > </span>
<a id="L328"></a><span class="visited"> </span>
<a id="L329"></a><span > </span>
<a id="L330"></a><span class="visited"> </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span class="visited"> </span>
<a id="L333"></a><span > </span>
<a id="L334"></a><span > </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span class="visited"> </span>
<a id="L337"></a><span class="visited"> </span>
<a id="L338"></a><span class="visited"> </span>
<a id="L339"></a><span > </span>
<a id="L340"></a><span > </span>
<a id="L341"></a><span > </span>
<a id="L342"></a><span class="visited"> </span>
<a id="L343"></a><span > </span>
<a id="L344"></a><span > </span>
<a id="L345"></a><span class="visited"> </span>
<a id="L346"></a><span > </span>
<a id="L347"></a><span > </span>
<a id="L348"></a><span class="visited"> </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span > </span>
<a id="L351"></a><span class="visited"> </span>
<a id="L352"></a><span class="visited"> </span>
<a id="L353"></a><span > </span>
<a id="L354"></a><span > </span>
<a id="L355"></a><span > </span>
<a id="L356"></a><span > </span>
<a id="L357"></a><span > </span>
<a id="L358"></a><span > </span>
<a id="L359"></a><span > </span>
<a id="L360"></a><span > </span>
<a id="L361"></a><span > </span>
<a id="L362"></a><span > </span>
<a id="L363"></a><span > </span>
<a id="L364"></a><span > </span>
<a id="L365"></a><span > </span>
<a id="L366"></a><span > </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span > </span>
<a id="L369"></a><span > </span>
<a id="L370"></a><span > </span>
<a id="L371"></a><span > </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span > </span>
<a id="L374"></a><span > </span>
<a id="L375"></a><span > </span>
<a id="L376"></a><span > </span>
<a id="L377"></a><span > </span>
<a id="L378"></a><span > </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span > </span>
<a id="L382"></a><span > </span>
<a id="L383"></a><span > </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span > </span>
<a id="L387"></a><span > </span>
<a id="L388"></a><span > </span>
<a id="L389"></a><span > </span>
<a id="L390"></a><span > </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span > </span>
<a id="L393"></a><span > </span>
<a id="L394"></a><span > </span>
<a id="L395"></a><span > </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span > </span>
<a id="L398"></a><span > </span>
<a id="L399"></a><span > </span>
<a id="L400"></a><span > </span>
<a id="L401"></a><span > </span>
<a id="L402"></a><span > </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
<a id="L405"></a><span > </span>
<a id="L406"></a><span > </span>
<a id="L407"></a><span > </span>
<a id="L408"></a><span > </span>
<a id="L409"></a><span > </span>
<a id="L410"></a><span > </span>
<a id="L411"></a><span > </span>
<a id="L412"></a><span > </span>
<a id="L413"></a><span > </span>
<a id="L414"></a><span > </span>
<a id="L415"></a><span > </span>
<a id="L416"></a><span > </span>
<a id="L417"></a><span > </span>
<a id="L418"></a><span > </span>
<a id="L419"></a><span > </span>
<a id="L420"></a><span > </span>
<a id="L421"></a><span > </span>
<a id="L422"></a><span > </span>
<a id="L423"></a><span > </span>
<a id="L424"></a><span > </span>
<a id="L425"></a><span > </span>
<a id="L426"></a><span > </span>
<a id="L427"></a><span > </span>
<a id="L428"></a><span > </span>
<a id="L429"></a><span > </span>
<a id="L430"></a><span > </span>
<a id="L431"></a><span > </span>
<a id="L432"></a><span > </span>
<a id="L433"></a><span > </span>
<a id="L434"></a><span > </span>
<a id="L435"></a><span > </span>
<a id="L436"></a><span > </span>
<a id="L437"></a><span class="visited"> </span>
<a id="L438"></a><span class="visited"> </span>
<a id="L439"></a><span class="visited"> </span>
<a id="L440"></a><span class="visited"> </span>
<a id="L441"></a><span class="visited"> </span>
<a id="L442"></a><span > </span>
<a id="L443"></a><span > </span>
<a id="L444"></a><span > </span>
<a id="L445"></a><span > </span>
<a id="L446"></a><span > </span>
<a id="L447"></a><span > </span>
<a id="L448"></a><span > </span>
<a id="L449"></a><span > </span>
<a id="L450"></a><span > </span>
<a id="L451"></a><span > </span>
<a id="L452"></a><span > </span>
<a id="L453"></a><span > </span>
<a id="L454"></a><span > </span>
<a id="L455"></a><span > </span>
<a id="L456"></a><span class="visited"> </span>
<a id="L457"></a><span class="visited"> </span>
<a id="L458"></a><span > </span>
<a id="L459"></a><span > </span>
<a id="L460"></a><span > </span>
<a id="L461"></a><span > </span>
<a id="L462"></a><span > </span>
<a id="L463"></a><span > </span>
<a id="L464"></a><span > </span>
<a id="L465"></a><span > </span>
<a id="L466"></a><span class="visited"> </span>
<a id="L467"></a><span class="visited"> </span>
<a id="L468"></a><span class="visited"> </span>
<a id="L469"></a><span class="visited"> </span>
<a id="L470"></a><span > </span>
<a id="L471"></a><span class="visited"> </span>
<a id="L472"></a><span class="visited"> </span>
<a id="L473"></a><span class="visited"> </span>
<a id="L474"></a><span class="visited"> </span>
<a id="L475"></a><span class="visited"> </span>
<a id="L476"></a><span class="visited"> </span>
<a id="L477"></a><span > </span>
<a id="L478"></a><span > </span>
<a id="L479"></a><span class="visited"> </span>
<a id="L480"></a><span > </span>
<a id="L481"></a><span class="visited"> </span>
<a id="L482"></a><span > </span>
<a id="L483"></a><span class="visited"> </span>
<a id="L484"></a><span > </span>
<a id="L485"></a><span > </span>
<a id="L486"></a><span > </span>
<a id="L487"></a><span > </span>
<a id="L488"></a><span > </span>
<a id="L489"></a><span > </span>
<a id="L490"></a><span > </span>
<a id="L491"></a><span > </span>
<a id="L492"></a><span class="visited"> </span>
<a id="L493"></a><span class="visited"> </span>
<a id="L494"></a><span class="visited"> </span>
<a id="L495"></a><span class="visited"> </span>
<a id="L496"></a><span class="visited"> </span>
<a id="L497"></a><span > </span>
<a id="L498"></a><span class="visited"> </span>
<a id="L499"></a><span > </span>
<a id="L500"></a><span class="visited"> </span>
<a id="L501"></a><span > </span>
<a id="L502"></a><span class="visited"> </span>
<a id="L503"></a><span > </span>
<a id="L504"></a><span class="visited"> </span>
<a id="L505"></a><span class="visited"> </span>
<a id="L506"></a><span class="visited"> </span>
<a id="L507"></a><span class="visited"> </span>
<a id="L508"></a><span > </span>
<a id="L509"></a><span class="visited"> </span>
<a id="L510"></a><span class="visited"> </span>
<a id="L511"></a><span class="visited"> </span>
<a id="L512"></a><span > </span>
<a id="L513"></a><span > </span>
<a id="L514"></a><span > </span>
<a id="L515"></a><span > </span>
<a id="L516"></a><span > </span>
<a id="L517"></a><span > </span>
<a id="L518"></a><span > </span>
<a id="L519"></a><span > </span>
<a id="L520"></a><span class="visited"> </span>
<a id="L521"></a><span class="visited"> </span>
<a id="L522"></a><span class="visited"> </span>
<a id="L523"></a><span > </span>
<a id="L524"></a><span > </span>
<a id="L525"></a><span > </span>
<a id="L526"></a><span > </span>
<a id="L527"></a><span > </span>
<a id="L528"></a><span > </span>
<a id="L529"></a><span > </span>
<a id="L530"></a><span > </span>
<a id="L531"></a><span > </span>
<a id="L532"></a><span > </span>
<a id="L533"></a><span > </span>
<a id="L534"></a><span > </span>
<a id="L535"></a><span > </span>
<a id="L536"></a><span > </span>
<a id="L537"></a><span > </span>
<a id="L538"></a><span > </span>
<a id="L539"></a><span > </span>
<a id="L540"></a><span > </span>
<a id="L541"></a><span > </span>
<a id="L542"></a><span > </span>
<a id="L543"></a><span > </span>
<a id="L544"></a><span > </span>
<a id="L545"></a><span > </span>
<a id="L546"></a><span > </span>
<a id="L547"></a><span > </span>
<a id="L548"></a><span > </span>
<a id="L549"></a><span > </span>
<a id="L550"></a><span > </span>
<a id="L551"></a><span > </span>
<a id="L552"></a><span class="visited"> </span>
<a id="L553"></a><span class="visited"> </span>
<a id="L554"></a><span class="visited"> </span>
<a id="L555"></a><span > </span>
<a id="L556"></a><span class="visited"> </span>
<a id="L557"></a><span class="visited"> </span>
<a id="L558"></a><span class="visited"> </span>
<a id="L559"></a><span class="visited"> </span>
<a id="L560"></a><span class="visited"> </span>
<a id="L561"></a><span class="visited"> </span>
<a id="L562"></a><span class="visited"> </span>
<a id="L563"></a><span > </span>
<a id="L564"></a><span > </span>
<a id="L565"></a><span > </span>
<a id="L566"></a><span > </span>
<a id="L567"></a><span > </span>
<a id="L568"></a><span > </span>
<a id="L569"></a><span class="visited"> </span>
<a id="L570"></a><span > </span>
<a id="L571"></a><span class="visited"> </span>
<a id="L572"></a><span > </span>
<a id="L573"></a><span > </span>
<a id="L574"></a><span > </span>
<a id="L575"></a><span > </span>
<a id="L576"></a><span > </span>
<a id="L577"></a><span > </span>
<a id="L578"></a><span class="visited"> </span>
<a id="L579"></a><span > </span>
<a id="L580"></a><span class="visited"> </span>
<a id="L581"></a><span class="visited"> </span>
<a id="L582"></a><span class="visited"> </span>
<a id="L583"></a><span class="visited"> </span>
<a id="L584"></a><span class="visited"> </span>
<a id="L585"></a><span class="visited"> </span>
<a id="L586"></a><span class="visited"> </span>
<a id="L587"></a><span class="visited"> </span>
<a id="L588"></a><span > </span>
<a id="L589"></a><span > </span>
<a id="L590"></a><span > </span>
<a id="L591"></a><span > </span>
<a id="L592"></a><span > </span>
<a id="L593"></a><span > </span>
<a id="L594"></a><span > </span>
<a id="L595"></a><span class="visited"> </span>
<a id="L596"></a><span > </span>
<a id="L597"></a><span > </span>
<a id="L598"></a><span class="visited"> </span>
<a id="L599"></a><span > </span>
<a id="L600"></a><span > </span>
<a id="L601"></a><span > </span>
<a id="L602"></a><span > </span>
<a id="L603"></a><span > </span>
<a id="L604"></a><span > </span>
<a id="L605"></a><span class="visited"> </span>
<a id="L606"></a><span class="visited"> </span>
<a id="L607"></a><span class="visited"> </span>
<a id="L608"></a><span class="visited"> </span>
<a id="L609"></a><span class="visited"> </span>
<a id="L610"></a><span class="visited"> </span>
<a id="L611"></a><span class="visited"> </span>
<a id="L612"></a><span class="visited"> </span>
<a id="L613"></a><span class="visited"> </span>
<a id="L614"></a><span class="visited"> </span>
<a id="L615"></a><span class="visited"> </span>
<a id="L616"></a><span > </span>
<a id="L617"></a><span > </span>
<a id="L618"></a><span class="visited"> </span>
<a id="L619"></a><span > </span>
<a id="L620"></a><span > </span>
<a id="L621"></a><span > </span>
<a id="L622"></a><span class="visited"> </span>
<a id="L623"></a><span > </span>
<a id="L624"></a><span > </span>
<a id="L625"></a><span class="visited"> </span>
<a id="L626"></a><span class="visited"> </span>
<a id="L627"></a><span class="visited"> </span>
<a id="L628"></a><span class="visited"> </span>
<a id="L629"></a><span > </span>
<a id="L630"></a><span class="visited"> </span>
<a id="L631"></a><span class="visited"> </span>
<a id="L632"></a><span class="visited"> </span>
<a id="L633"></a><span > </span>
<a id="L634"></a><span class="visited"> </span>
<a id="L635"></a><span class="visited"> </span>
<a id="L636"></a><span > </span>
<a id="L637"></a><span class="visited"> </span>
<a id="L638"></a><span > </span>
<a id="L639"></a><span class="visited"> </span>
<a id="L640"></a><span class="visited"> </span>
<a id="L641"></a><span class="visited"> </span>
<a id="L642"></a><span > </span>
<a id="L643"></a><span class="visited"> </span>
<a id="L644"></a><span > </span>
<a id="L645"></a><span class="visited"> </span>
<a id="L646"></a><span class="visited"> </span>
<a id="L647"></a><span class="visited"> </span>
<a id="L648"></a><span class="visited"> </span>
<a id="L649"></a><span class="visited"> </span>
<a id="L650"></a><span > </span>
<a id="L651"></a><span class="visited"> </span>
<a id="L652"></a><span class="visited"> </span>
<a id="L653"></a><span class="visited"> </span>
<a id="L654"></a><span > </span>
<a id="L655"></a><span class="visited"> </span>
<a id="L656"></a><span > </span>
<a id="L657"></a><span class="visited"> </span>
<a id="L658"></a><span > </span>
<a id="L659"></a><span > </span>
<a id="L660"></a><span class="visited"> </span>
<a id="L661"></a><span class="visited"> </span>
<a id="L662"></a><span class="visited"> </span>
<a id="L663"></a><span class="visited"> </span>
<a id="L664"></a><span class="visited"> </span>
<a id="L665"></a><span class="visited"> </span>
<a id="L666"></a><span > </span>
<a id="L667"></a><span > </span>
<a id="L668"></a><span > </span>
<a id="L669"></a><span > </span>
<a id="L670"></a><span > </span>
<a id="L671"></a><span > </span>
<a id="L672"></a><span > </span>
<a id="L673"></a><span > </span>
<a id="L674"></a><span > </span>
<a id="L675"></a><span > </span>
<a id="L676"></a><span class="visited"> </span>
<a id="L677"></a><span class="visited"> </span>
<a id="L678"></a><span class="visited"> </span>
<a id="L679"></a><span class="visited"> </span>
<a id="L680"></a><span class="visited"> </span>
<a id="L681"></a><span class="visited"> </span>
<a id="L682"></a><span > </span>
<a id="L683"></a><span class="visited"> </span>
<a id="L684"></a><span > </span>
<a id="L685"></a><span class="visited"> </span>
<a id="L686"></a><span class="visited"> </span>
<a id="L687"></a><span class="visited"> </span>
<a id="L688"></a><span class="visited"> </span>
<a id="L689"></a><span class="visited"> </span>
<a id="L690"></a><span > </span>
<a id="L691"></a><span > </span>
<a id="L692"></a><span > </span>
<a id="L693"></a><span > </span>
<a id="L694"></a><span class="visited"> </span>
<a id="L695"></a><span class="visited"> </span>
<a id="L696"></a><span class="visited"> </span>
<a id="L697"></a><span class="visited"> </span>
<a id="L698"></a><span class="visited"> </span>
<a id="L699"></a><span > </span>
<a id="L700"></a><span > </span>
<a id="L701"></a><span > </span>
<a id="L702"></a><span > </span>
<a id="L703"></a><span > </span>
<a id="L704"></a><span class="visited"> </span>
<a id="L705"></a><span > </span>
<a id="L706"></a><span > </span>
<a id="L707"></a><span class="visited"> </span>
<a id="L708"></a><span class="visited"> </span>
<a id="L709"></a><span > </span>
<a id="L710"></a><span class="visited"> </span>
<a id="L711"></a><span class="visited"> </span>
<a id="L712"></a><span class="visited"> </span>
<a id="L713"></a><span > </span>
<a id="L714"></a><span > </span>
<a id="L715"></a><span class="visited"> </span>
<a id="L716"></a><span > </span>
<a id="L717"></a><span > </span>
<a id="L718"></a><span class="visited"> </span>
<a id="L719"></a><span class="visited"> </span>
<a id="L720"></a><span class="visited"> </span>
<a id="L721"></a><span class="visited"> </span>
<a id="L722"></a><span > </span>
<a id="L723"></a><span > </span>
<a id="L724"></a><span > </span>
<a id="L725"></a><span > </span>
<a id="L726"></a><span > </span>
<a id="L727"></a><span > </span>
<a id="L728"></a><span > </span>
<a id="L729"></a><span > </span>
<a id="L730"></a><span > </span>
<a id="L731"></a><span > </span>
<a id="L732"></a><span > </span>
<a id="L733"></a><span > </span>
<a id="L734"></a><span > </span>
<a id="L735"></a><span > </span>
<a id="L736"></a><span > </span>
<a id="L737"></a><span > </span>
<a id="L738"></a><span > </span>
<a id="L739"></a><span class="visited"> </span>
<a id="L740"></a><span class="visited"> </span>
<a id="L741"></a><span class="visited"> </span>
<a id="L742"></a><span class="visited"> </span>
<a id="L743"></a><span class="visited"> </span>
<a id="L744"></a><span class="visited"> </span>
<a id="L745"></a><span class="visited"> </span>
<a id="L746"></a><span class="visited"> </span>
<a id="L747"></a><span class="visited"> </span>
<a id="L748"></a><span class="visited"> </span>
<a id="L749"></a><span class="visited"> </span>
<a id="L750"></a><span class="visited"> </span>
<a id="L751"></a><span > </span>
<a id="L752"></a><span class="visited"> </span>
<a id="L753"></a><span class="visited"> </span>
<a id="L754"></a><span class="visited"> </span>
<a id="L755"></a><span class="visited"> </span>
<a id="L756"></a><span class="visited"> </span>
<a id="L757"></a><span class="visited"> </span>
<a id="L758"></a><span class="visited"> </span>
<a id="L759"></a><span > </span>
<a id="L760"></a><span class="visited"> </span>
<a id="L761"></a><span > </span>
<a id="L762"></a><span > </span>
<a id="L763"></a><span > </span>
<a id="L764"></a><span > </span>
<a id="L765"></a><span class="visited"> </span>
<a id="L766"></a><span > </span>
<a id="L767"></a><span > </span>
<a id="L768"></a><span class="visited"> </span>
<a id="L769"></a><span > </span>
<a id="L770"></a><span > </span>
<a id="L771"></a><span > </span>
<a id="L772"></a><span class="visited"> </span>
<a id="L773"></a><span class="visited"> </span>
<a id="L774"></a><span class="visited"> </span>
<a id="L775"></a><span class="visited"> </span>
<a id="L776"></a><span class="visited"> </span>
<a id="L777"></a><span class="visited"> </span>
<a id="L778"></a><span class="visited"> </span>
<a id="L779"></a><span class="visited"> </span>
<a id="L780"></a><span class="visited"> </span>
<a id="L781"></a><span class="visited"> </span>
<a id="L782"></a><span class="visited"> </span>
<a id="L783"></a><span class="visited"> </span>
<a id="L784"></a><span class="visited"> </span>
<a id="L785"></a><span > </span>
<a id="L786"></a><span class="visited"> </span>
<a id="L787"></a><span class="visited"> </span>
<a id="L788"></a><span class="visited"> </span>
<a id="L789"></a><span class="visited"> </span>
<a id="L790"></a><span class="visited"> </span>
<a id="L791"></a><span > </span>
<a id="L792"></a><span > </span>
<a id="L793"></a><span class="visited"> </span>
<a id="L794"></a><span class="visited"> </span>
<a id="L795"></a><span > </span>
<a id="L796"></a><span class="visited"> </span>
<a id="L797"></a><span > </span>
<a id="L798"></a><span class="visited"> </span>
<a id="L799"></a><span > </span>
<a id="L800"></a><span > </span>
<a id="L801"></a><span class="visited"> </span>
<a id="L802"></a><span > </span>
<a id="L803"></a><span > </span>
<a id="L804"></a><span > </span>
<a id="L805"></a><span > </span>
<a id="L806"></a><span > </span>
<a id="L807"></a><span > </span>
<a id="L808"></a><span > </span>
<a id="L809"></a><span class="visited"> </span>
<a id="L810"></a><span class="visited"> </span>
<a id="L811"></a><span class="visited"> </span>
<a id="L812"></a><span > </span>
<a id="L813"></a><span class="visited"> </span>
<a id="L814"></a><span class="visited"> </span>
<a id="L815"></a><span class="visited"> </span>
<a id="L816"></a><span > </span>
<a id="L817"></a><span class="visited"> </span>
<a id="L818"></a><span > </span>
<a id="L819"></a><span > </span>
<a id="L820"></a><span > </span>
<a id="L821"></a><span > </span>
<a id="L822"></a><span > </span>
<a id="L823"></a><span > </span>
<a id="L824"></a><span > </span>
<a id="L825"></a><span > </span>
<a id="L826"></a><span class="visited"> </span>
<a id="L827"></a><span class="visited"> </span>
<a id="L828"></a><span class="visited"> </span>
<a id="L829"></a><span > </span>
<a id="L830"></a><span class="visited"> </span>
<a id="L831"></a><span > </span>
<a id="L832"></a><span > </span>
<a id="L833"></a><span > </span>
<a id="L834"></a><span > </span>
<a id="L835"></a><span > </span>
<a id="L836"></a><span > </span>
<a id="L837"></a><span class="visited"> </span>
<a id="L838"></a><span class="visited"> </span>
<a id="L839"></a><span class="visited"> </span>
<a id="L840"></a><span > </span>
<a id="L841"></a><span > </span>
<a id="L842"></a><span class="visited"> </span>
<a id="L843"></a><span class="visited"> </span>
<a id="L844"></a><span > </span>
<a id="L845"></a><span > </span>
<a id="L846"></a><span class="visited"> </span>
<a id="L847"></a><span > </span>
<a id="L848"></a><span class="visited"> </span>
<a id="L849"></a><span class="visited"> </span>
<a id="L850"></a><span class="visited"> </span>
<a id="L851"></a><span class="visited"> </span>
<a id="L852"></a><span class="visited"> </span>
<a id="L853"></a><span > </span>
<a id="L854"></a><span class="visited"> </span>
<a id="L855"></a><span class="visited"> </span>
<a id="L856"></a><span > </span>
<a id="L857"></a><span class="visited"> </span>
<a id="L858"></a><span class="visited"> </span>
<a id="L859"></a><span class="visited"> </span>
<a id="L860"></a><span > </span>
<a id="L861"></a><span > </span>
<a id="L862"></a><span > </span>
<a id="L863"></a><span > </span>
<a id="L864"></a><span > </span>
<a id="L865"></a><span > </span>
<a id="L866"></a><span > </span>
<a id="L867"></a><span > </span>
<a id="L868"></a><span > </span>
<a id="L869"></a><span > </span>
<a id="L870"></a><span > </span>
<a id="L871"></a><span > </span>
<a id="L872"></a><span > </span>
<a id="L873"></a><span > </span>
<a id="L874"></a><span class="visited"> </span>
<a id="L875"></a><span class="visited"> </span>
<a id="L876"></a><span class="visited"> </span>
<a id="L877"></a><span class="visited"> </span>
<a id="L878"></a><span > </span>
<a id="L879"></a><span > </span>
<a id="L880"></a><span class="unvisited"> </span>
<a id="L881"></a><span class="unvisited"> </span>
<a id="L882"></a><span class="unvisited"> </span>
<a id="L883"></a><span class="unvisited"> </span>
<a id="L884"></a><span > </span>
<a id="L885"></a><span class="unvisited"> </span>
<a id="L886"></a><span class="unvisited"> </span>
<a id="L887"></a><span class="unvisited"> </span>
<a id="L888"></a><span class="unvisited"> </span>
<a id="L889"></a><span > </span>
<a id="L890"></a><span class="unvisited"> </span>
<a id="L891"></a><span class="unvisited"> </span>
<a id="L892"></a><span class="unvisited"> </span>
<a id="L893"></a><span class="unvisited"> </span>
<a id="L894"></a><span class="unvisited"> </span>
<a id="L895"></a><span > </span>
<a id="L896"></a><span > </span>
<a id="L897"></a><span > </span>
<a id="L898"></a><span class="visited"> </span>
<a id="L899"></a><span class="unvisited"> </span>
<a id="L900"></a><span > </span>
<a id="L901"></a><span class="visited"> </span>
<a id="L902"></a><span > </span>
<a id="L903"></a><span class="unvisited"> </span>
<a id="L904"></a><span class="unvisited"> </span>
<a id="L905"></a><span > </span>
<a id="L906"></a><span > </span>
<a id="L907"></a><span > </span>
<a id="L908"></a><span > </span>
<a id="L909"></a><span > </span>
<a id="L910"></a><span > </span>
<a id="L911"></a><span > </span>
<a id="L912"></a><span > </span>
<a id="L913"></a><span > </span>
<a id="L914"></a><span > </span>
<a id="L915"></a><span > </span>
<a id="L916"></a><span > </span>
<a id="L917"></a><span > </span>
<a id="L918"></a><span > </span>
<a id="L919"></a><span > </span>
<a id="L920"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
<a href="#L422">422</a>
<a href="#L423">423</a>
<a href="#L424">424</a>
<a href="#L425">425</a>
<a href="#L426">426</a>
<a href="#L427">427</a>
<a href="#L428">428</a>
<a href="#L429">429</a>
<a href="#L430">430</a>
<a href="#L431">431</a>
<a href="#L432">432</a>
<a href="#L433">433</a>
<a href="#L434">434</a>
<a href="#L435">435</a>
<a href="#L436">436</a>
<a href="#L437">437</a>
<a href="#L438">438</a>
<a href="#L439">439</a>
<a href="#L440">440</a>
<a href="#L441">441</a>
<a href="#L442">442</a>
<a href="#L443">443</a>
<a href="#L444">444</a>
<a href="#L445">445</a>
<a href="#L446">446</a>
<a href="#L447">447</a>
<a href="#L448">448</a>
<a href="#L449">449</a>
<a href="#L450">450</a>
<a href="#L451">451</a>
<a href="#L452">452</a>
<a href="#L453">453</a>
<a href="#L454">454</a>
<a href="#L455">455</a>
<a href="#L456">456</a>
<a href="#L457">457</a>
<a href="#L458">458</a>
<a href="#L459">459</a>
<a href="#L460">460</a>
<a href="#L461">461</a>
<a href="#L462">462</a>
<a href="#L463">463</a>
<a href="#L464">464</a>
<a href="#L465">465</a>
<a href="#L466">466</a>
<a href="#L467">467</a>
<a href="#L468">468</a>
<a href="#L469">469</a>
<a href="#L470">470</a>
<a href="#L471">471</a>
<a href="#L472">472</a>
<a href="#L473">473</a>
<a href="#L474">474</a>
<a href="#L475">475</a>
<a href="#L476">476</a>
<a href="#L477">477</a>
<a href="#L478">478</a>
<a href="#L479">479</a>
<a href="#L480">480</a>
<a href="#L481">481</a>
<a href="#L482">482</a>
<a href="#L483">483</a>
<a href="#L484">484</a>
<a href="#L485">485</a>
<a href="#L486">486</a>
<a href="#L487">487</a>
<a href="#L488">488</a>
<a href="#L489">489</a>
<a href="#L490">490</a>
<a href="#L491">491</a>
<a href="#L492">492</a>
<a href="#L493">493</a>
<a href="#L494">494</a>
<a href="#L495">495</a>
<a href="#L496">496</a>
<a href="#L497">497</a>
<a href="#L498">498</a>
<a href="#L499">499</a>
<a href="#L500">500</a>
<a href="#L501">501</a>
<a href="#L502">502</a>
<a href="#L503">503</a>
<a href="#L504">504</a>
<a href="#L505">505</a>
<a href="#L506">506</a>
<a href="#L507">507</a>
<a href="#L508">508</a>
<a href="#L509">509</a>
<a href="#L510">510</a>
<a href="#L511">511</a>
<a href="#L512">512</a>
<a href="#L513">513</a>
<a href="#L514">514</a>
<a href="#L515">515</a>
<a href="#L516">516</a>
<a href="#L517">517</a>
<a href="#L518">518</a>
<a href="#L519">519</a>
<a href="#L520">520</a>
<a href="#L521">521</a>
<a href="#L522">522</a>
<a href="#L523">523</a>
<a href="#L524">524</a>
<a href="#L525">525</a>
<a href="#L526">526</a>
<a href="#L527">527</a>
<a href="#L528">528</a>
<a href="#L529">529</a>
<a href="#L530">530</a>
<a href="#L531">531</a>
<a href="#L532">532</a>
<a href="#L533">533</a>
<a href="#L534">534</a>
<a href="#L535">535</a>
<a href="#L536">536</a>
<a href="#L537">537</a>
<a href="#L538">538</a>
<a href="#L539">539</a>
<a href="#L540">540</a>
<a href="#L541">541</a>
<a href="#L542">542</a>
<a href="#L543">543</a>
<a href="#L544">544</a>
<a href="#L545">545</a>
<a href="#L546">546</a>
<a href="#L547">547</a>
<a href="#L548">548</a>
<a href="#L549">549</a>
<a href="#L550">550</a>
<a href="#L551">551</a>
<a href="#L552">552</a>
<a href="#L553">553</a>
<a href="#L554">554</a>
<a href="#L555">555</a>
<a href="#L556">556</a>
<a href="#L557">557</a>
<a href="#L558">558</a>
<a href="#L559">559</a>
<a href="#L560">560</a>
<a href="#L561">561</a>
<a href="#L562">562</a>
<a href="#L563">563</a>
<a href="#L564">564</a>
<a href="#L565">565</a>
<a href="#L566">566</a>
<a href="#L567">567</a>
<a href="#L568">568</a>
<a href="#L569">569</a>
<a href="#L570">570</a>
<a href="#L571">571</a>
<a href="#L572">572</a>
<a href="#L573">573</a>
<a href="#L574">574</a>
<a href="#L575">575</a>
<a href="#L576">576</a>
<a href="#L577">577</a>
<a href="#L578">578</a>
<a href="#L579">579</a>
<a href="#L580">580</a>
<a href="#L581">581</a>
<a href="#L582">582</a>
<a href="#L583">583</a>
<a href="#L584">584</a>
<a href="#L585">585</a>
<a href="#L586">586</a>
<a href="#L587">587</a>
<a href="#L588">588</a>
<a href="#L589">589</a>
<a href="#L590">590</a>
<a href="#L591">591</a>
<a href="#L592">592</a>
<a href="#L593">593</a>
<a href="#L594">594</a>
<a href="#L595">595</a>
<a href="#L596">596</a>
<a href="#L597">597</a>
<a href="#L598">598</a>
<a href="#L599">599</a>
<a href="#L600">600</a>
<a href="#L601">601</a>
<a href="#L602">602</a>
<a href="#L603">603</a>
<a href="#L604">604</a>
<a href="#L605">605</a>
<a href="#L606">606</a>
<a href="#L607">607</a>
<a href="#L608">608</a>
<a href="#L609">609</a>
<a href="#L610">610</a>
<a href="#L611">611</a>
<a href="#L612">612</a>
<a href="#L613">613</a>
<a href="#L614">614</a>
<a href="#L615">615</a>
<a href="#L616">616</a>
<a href="#L617">617</a>
<a href="#L618">618</a>
<a href="#L619">619</a>
<a href="#L620">620</a>
<a href="#L621">621</a>
<a href="#L622">622</a>
<a href="#L623">623</a>
<a href="#L624">624</a>
<a href="#L625">625</a>
<a href="#L626">626</a>
<a href="#L627">627</a>
<a href="#L628">628</a>
<a href="#L629">629</a>
<a href="#L630">630</a>
<a href="#L631">631</a>
<a href="#L632">632</a>
<a href="#L633">633</a>
<a href="#L634">634</a>
<a href="#L635">635</a>
<a href="#L636">636</a>
<a href="#L637">637</a>
<a href="#L638">638</a>
<a href="#L639">639</a>
<a href="#L640">640</a>
<a href="#L641">641</a>
<a href="#L642">642</a>
<a href="#L643">643</a>
<a href="#L644">644</a>
<a href="#L645">645</a>
<a href="#L646">646</a>
<a href="#L647">647</a>
<a href="#L648">648</a>
<a href="#L649">649</a>
<a href="#L650">650</a>
<a href="#L651">651</a>
<a href="#L652">652</a>
<a href="#L653">653</a>
<a href="#L654">654</a>
<a href="#L655">655</a>
<a href="#L656">656</a>
<a href="#L657">657</a>
<a href="#L658">658</a>
<a href="#L659">659</a>
<a href="#L660">660</a>
<a href="#L661">661</a>
<a href="#L662">662</a>
<a href="#L663">663</a>
<a href="#L664">664</a>
<a href="#L665">665</a>
<a href="#L666">666</a>
<a href="#L667">667</a>
<a href="#L668">668</a>
<a href="#L669">669</a>
<a href="#L670">670</a>
<a href="#L671">671</a>
<a href="#L672">672</a>
<a href="#L673">673</a>
<a href="#L674">674</a>
<a href="#L675">675</a>
<a href="#L676">676</a>
<a href="#L677">677</a>
<a href="#L678">678</a>
<a href="#L679">679</a>
<a href="#L680">680</a>
<a href="#L681">681</a>
<a href="#L682">682</a>
<a href="#L683">683</a>
<a href="#L684">684</a>
<a href="#L685">685</a>
<a href="#L686">686</a>
<a href="#L687">687</a>
<a href="#L688">688</a>
<a href="#L689">689</a>
<a href="#L690">690</a>
<a href="#L691">691</a>
<a href="#L692">692</a>
<a href="#L693">693</a>
<a href="#L694">694</a>
<a href="#L695">695</a>
<a href="#L696">696</a>
<a href="#L697">697</a>
<a href="#L698">698</a>
<a href="#L699">699</a>
<a href="#L700">700</a>
<a href="#L701">701</a>
<a href="#L702">702</a>
<a href="#L703">703</a>
<a href="#L704">704</a>
<a href="#L705">705</a>
<a href="#L706">706</a>
<a href="#L707">707</a>
<a href="#L708">708</a>
<a href="#L709">709</a>
<a href="#L710">710</a>
<a href="#L711">711</a>
<a href="#L712">712</a>
<a href="#L713">713</a>
<a href="#L714">714</a>
<a href="#L715">715</a>
<a href="#L716">716</a>
<a href="#L717">717</a>
<a href="#L718">718</a>
<a href="#L719">719</a>
<a href="#L720">720</a>
<a href="#L721">721</a>
<a href="#L722">722</a>
<a href="#L723">723</a>
<a href="#L724">724</a>
<a href="#L725">725</a>
<a href="#L726">726</a>
<a href="#L727">727</a>
<a href="#L728">728</a>
<a href="#L729">729</a>
<a href="#L730">730</a>
<a href="#L731">731</a>
<a href="#L732">732</a>
<a href="#L733">733</a>
<a href="#L734">734</a>
<a href="#L735">735</a>
<a href="#L736">736</a>
<a href="#L737">737</a>
<a href="#L738">738</a>
<a href="#L739">739</a>
<a href="#L740">740</a>
<a href="#L741">741</a>
<a href="#L742">742</a>
<a href="#L743">743</a>
<a href="#L744">744</a>
<a href="#L745">745</a>
<a href="#L746">746</a>
<a href="#L747">747</a>
<a href="#L748">748</a>
<a href="#L749">749</a>
<a href="#L750">750</a>
<a href="#L751">751</a>
<a href="#L752">752</a>
<a href="#L753">753</a>
<a href="#L754">754</a>
<a href="#L755">755</a>
<a href="#L756">756</a>
<a href="#L757">757</a>
<a href="#L758">758</a>
<a href="#L759">759</a>
<a href="#L760">760</a>
<a href="#L761">761</a>
<a href="#L762">762</a>
<a href="#L763">763</a>
<a href="#L764">764</a>
<a href="#L765">765</a>
<a href="#L766">766</a>
<a href="#L767">767</a>
<a href="#L768">768</a>
<a href="#L769">769</a>
<a href="#L770">770</a>
<a href="#L771">771</a>
<a href="#L772">772</a>
<a href="#L773">773</a>
<a href="#L774">774</a>
<a href="#L775">775</a>
<a href="#L776">776</a>
<a href="#L777">777</a>
<a href="#L778">778</a>
<a href="#L779">779</a>
<a href="#L780">780</a>
<a href="#L781">781</a>
<a href="#L782">782</a>
<a href="#L783">783</a>
<a href="#L784">784</a>
<a href="#L785">785</a>
<a href="#L786">786</a>
<a href="#L787">787</a>
<a href="#L788">788</a>
<a href="#L789">789</a>
<a href="#L790">790</a>
<a href="#L791">791</a>
<a href="#L792">792</a>
<a href="#L793">793</a>
<a href="#L794">794</a>
<a href="#L795">795</a>
<a href="#L796">796</a>
<a href="#L797">797</a>
<a href="#L798">798</a>
<a href="#L799">799</a>
<a href="#L800">800</a>
<a href="#L801">801</a>
<a href="#L802">802</a>
<a href="#L803">803</a>
<a href="#L804">804</a>
<a href="#L805">805</a>
<a href="#L806">806</a>
<a href="#L807">807</a>
<a href="#L808">808</a>
<a href="#L809">809</a>
<a href="#L810">810</a>
<a href="#L811">811</a>
<a href="#L812">812</a>
<a href="#L813">813</a>
<a href="#L814">814</a>
<a href="#L815">815</a>
<a href="#L816">816</a>
<a href="#L817">817</a>
<a href="#L818">818</a>
<a href="#L819">819</a>
<a href="#L820">820</a>
<a href="#L821">821</a>
<a href="#L822">822</a>
<a href="#L823">823</a>
<a href="#L824">824</a>
<a href="#L825">825</a>
<a href="#L826">826</a>
<a href="#L827">827</a>
<a href="#L828">828</a>
<a href="#L829">829</a>
<a href="#L830">830</a>
<a href="#L831">831</a>
<a href="#L832">832</a>
<a href="#L833">833</a>
<a href="#L834">834</a>
<a href="#L835">835</a>
<a href="#L836">836</a>
<a href="#L837">837</a>
<a href="#L838">838</a>
<a href="#L839">839</a>
<a href="#L840">840</a>
<a href="#L841">841</a>
<a href="#L842">842</a>
<a href="#L843">843</a>
<a href="#L844">844</a>
<a href="#L845">845</a>
<a href="#L846">846</a>
<a href="#L847">847</a>
<a href="#L848">848</a>
<a href="#L849">849</a>
<a href="#L850">850</a>
<a href="#L851">851</a>
<a href="#L852">852</a>
<a href="#L853">853</a>
<a href="#L854">854</a>
<a href="#L855">855</a>
<a href="#L856">856</a>
<a href="#L857">857</a>
<a href="#L858">858</a>
<a href="#L859">859</a>
<a href="#L860">860</a>
<a href="#L861">861</a>
<a href="#L862">862</a>
<a href="#L863">863</a>
<a href="#L864">864</a>
<a href="#L865">865</a>
<a href="#L866">866</a>
<a href="#L867">867</a>
<a href="#L868">868</a>
<a href="#L869">869</a>
<a href="#L870">870</a>
<a href="#L871">871</a>
<a href="#L872">872</a>
<a href="#L873">873</a>
<a href="#L874">874</a>
<a href="#L875">875</a>
<a href="#L876">876</a>
<a href="#L877">877</a>
<a href="#L878">878</a>
<a href="#L879">879</a>
<a href="#L880">880</a>
<a href="#L881">881</a>
<a href="#L882">882</a>
<a href="#L883">883</a>
<a href="#L884">884</a>
<a href="#L885">885</a>
<a href="#L886">886</a>
<a href="#L887">887</a>
<a href="#L888">888</a>
<a href="#L889">889</a>
<a href="#L890">890</a>
<a href="#L891">891</a>
<a href="#L892">892</a>
<a href="#L893">893</a>
<a href="#L894">894</a>
<a href="#L895">895</a>
<a href="#L896">896</a>
<a href="#L897">897</a>
<a href="#L898">898</a>
<a href="#L899">899</a>
<a href="#L900">900</a>
<a href="#L901">901</a>
<a href="#L902">902</a>
<a href="#L903">903</a>
<a href="#L904">904</a>
<a href="#L905">905</a>
<a href="#L906">906</a>
<a href="#L907">907</a>
<a href="#L908">908</a>
<a href="#L909">909</a>
<a href="#L910">910</a>
<a href="#L911">911</a>
<a href="#L912">912</a>
<a href="#L913">913</a>
<a href="#L914">914</a>
<a href="#L915">915</a>
<a href="#L916">916</a>
<a href="#L917">917</a>
<a href="#L918">918</a>
<a href="#L919">919</a>
<a href="#L920">920</a>
</pre>
        <pre id="code">
(*---------------------------------------------------------------------------
   Copyright (c) 2017 Tony Wuersch. All rights reserved.
   Distributed under the ISC license, see terms at the end of the file.
   %%NAME%% %%VERSION%%
  ---------------------------------------------------------------------------*)

(* an ocaml version of Openssl's conf library

    {e %%VERSION%%  {{:%%PKG_HOMEPAGE%% }homepage}} *)

(* Intro

   Welcome to the implementation of Sslconf!

   0. Origin

   Sslconf recodes Openssl's NCONF "new config" parser in OCaml.
   The recoding should be conforming but simpler, cleaner, and unit tested.

   Openssl code is at https://github.com/openssl/openssl/blob/master/ .
   The NCONF parser header is in "include/openssl" at "conf.h".
   NCONF parser code is in "crypto/conf" at

   - "conf_def.c"
   - "conf_api.c", and
   - "conf_lib.c".

   1. Line handling

   This describes [continued_line], [getline], [Buf.grow], and [Bio.gets].

   NCONF opens, reads, and parses a text file.

   Lines in the text file are terminated by newlines, either

   - Unix-style line feeds (LF), or
   - Windows style carrage return line feeds (CRLF).

   A text file read scans for a newline.
   The scan is limited up to a maximum block size (512 bytes).
   Maximum block size is 512 bytes.

   Reads go in a buffer.
   The maximum size of the buffer is bounded by a bit size length.
   Default bit size length is 31 bits.
   Unit tests can reduce buffer bit size length in order to trigger errors.

   The buffer is resized:

   - if a line is longer than the maximum block size; or
   - if the character immediately before the newline is a continuation
     character ['\\'], and the continuation character is not immediately
     preceded by another continuation character ['\\'].

   A line, for NCONF, is the sequence of lines, each separated by a
   continuation character.

   The newline at the end of a line is stripped out.
   Each newline preceded by a continuation characters is also stripped out,
   and its continuation character is stripped out too.

   If a line ends at the end of a file and no newline is present, then
   nothing is stripped out, unless a continuation character is present,
   in which case it alone is stripped out.

   For error reporting, this implementation saves the offsets of
   continued lines in the structure of a line.  Using these offsets,
   when an error happens, error reporting reports:

   - the line number of the error in the text file, and
   - the position of the error relative to the line in the text file.

   The structure of a line is defined in [continued_line].

   Two error types are defined relative to line handling:

   - "Open": if the text file cannot be opened.
   - "Extend": if the buffer cannot be resized.

   2. Line parsing.

   Parsing [Sslconf.parse_line] returns two hash tables:

   - a hash table mapping section names to stacks of name-value pairs; and
   - a hash table mapping "&lt;section&gt;::&lt;name&gt;" keys to values.

   If parsing fails, an error is returned.
   Returns and errors use OCaml's result structure.

   2.1. Lines to the Parser

   The parser recognizes three kinds of lines:

   - an empty, blank or commented out line.
   - a line declaring a new section.
   - a line assigning a value to a name.

   See interface documentation for more detail on line types.
   Comments here are relevant to the implementation.

   2.1.1. Section lines.

   [parse_line] recognizes the beginning of a section line.
   It delegates section parsing to

   - a scanner loop using [span_with_escapes], and
   - a value evaluator [parse_value].

   Then it recognizes end of section.

   2.1.2. Name/Value Assignments.

   At the most general level, an NCONF name-value assignment
   is made up of:

   - a name, followed by
   - an equal sign (['=']), followed by
   - a value.

   If the equal sign is not present, and the line is not one
   of the other two types, the parser will quit in error, and
   will report that no equal sign was found.

   [parse_line] does this general work.

   - It delegates name recognition to [parse_name].
   - It recognizes the equal sign.
   - It delegates value reading and evaluation to [parse_value].
   - Then it returns a result.

   2.1.2.1. Names.

   A qualified name is made up of:

   - a section, followed by
   - two colon characters, i.e., ["::"], followed by
   - a name.

   If only one colon character is seen, the parser will quit
   with an error, that two colon characters were not seen.

   A name, and the section of a qualified name, share the same
   syntax rules. These rules are the same as the section in a
   section line, with two changes:

   - unescaped white space in a name is not allowed.
   - the resulting name is NOT further processed, so escape
     characters remain in the name.

   White space before and after a name, up to the equal sign,
   is ignored (dropped).

   2.1.2.2. Values.

   The parser quits with an error if an empty value is seen.
   This can occur if only white space follows the equal sign,
   or if only white space after the equal sign is ended by a
   hash character (comment to end of line).

   A small set of characters introduce or delimit special processing.

   - a dollar sign (['$'])
     with optional wrap characters (["()"] or ["{}"])
     introduces name substitution.
   - quotes (['\''] or ['"']) suppress processing in wrapped subparts.
   - an escape character (['\\']) admits the next character unconditionally,
     and suppresses processing from it.

   In the case of name substitution, a special subclass is
   names with section "ENV".  These substitute from the process
   environment.

   The parser strips out special characters from value results,
   unless their special meaning was cancelled.

   [parse_value] recognizes values in name-value assignments.
   It recognizes special characters and delegates their processing.

   - name substitution is handled by [subst].
   - Unix and Cygwin quote processing is handled by [parse_quote].
   - Win32 double quote processing is handled by [parse_dquote].
   - escape char processing is handled directly by [parse_value].

   Section line sections apply [parse_value] escape char processing.

   2.1.2.2.1. Name Substitution.

   [subst] handles name substitution.

   Name substitution replaces names with values. Names used must have
   previously assigned values, or they must have section ["ENV"], and
   their name must exist in the process environment.

   If a start wrap character (['('] or ['{']) immediately follows the
   dollar sign, then the name to substitute must be immediately followed
   by the end wrap character ([')'] or ['}'], or the parser will fail
   and report an error that no end wrap character was seen.

   Names which fail to have a previously assigned value, or which are
   qualified names with section ["ENV"], whose name is not in the process
   environment, will cause the parser to fail with an error that a name
   could not be resolved.

   Parsing of a name used in name substitution is like that of a name
   used in name-value assignments, but with one further restriction:

   - punctuation is not allowed.

   A name used in name substitution may have only

   - alphanumeric characters,
   - underscores, or
   - two-character escaped sequences.

   2.1.2.2.2. Quote Wrapping in Unix and Cygwin.

   [parse_quote] handles quote wrapped strings in Unix and Cygwin.

   A single quote string is ended when a single quote is found, unless the
   single quote is preceded by an escape character (['\\']).

   Escape chars allow the next char to always be in the substring.

   The parser strips out escape characters from the substring it adds to
   the value, unless the escape character is itself escaped.

   The parser strips out wrapping single quotes.

   2.1.2.2.3. Quote Wrapping in Win32 (double-quotes only).

   [parse_dquote] handles double quote wrapped strings in Windows.

   A double quote string is ended when a double quote is found, unless the
   double quote is immediately preceded by a double quote.

   If two double quotes appear in the string, the parser replaces them with
   one double quote in the substring it adds to the value.

   Escape characters have no interpretation in double-quote strings.  They
   appear as themselves, unmodified.

   The parser strips out wrapping double quotes.

   3. Implementation Notes.

   3.1. The Astring Package.

   This implementation primarily uses Daniel Buenzli's Astring package.
   Astring defines a substring structure over base strings.  A substring
   structure is an interval range (a start position and an end position)
   in a base string. Substring representation minimizes string copies
   and replaces them, wherever possible, with substring creations and
   modifications.

   Strings can be converted to substrings, and substrings back to strings. 
   Scanners can traverse substrings and apply character predicates, returning
   matched and unmatched ("remainder") sections. Head characters and tail
   substrings can be taken from substrings. Substring lists can be concatenated
   to create new substrings. The interval range of a substring can be altered
   ("extended") without creating a new base string.

   3.2. OUnit2, Bisect, and Sexplib Packages.

   For unit testing, we use OUnit2, Bisect, and Sexplib.

   Bisect assures us that unit tests have test coverage.

   Sexplib allows canonical and comparable strings to be generated
   from results. We may change the choice of Sexplib here, to use
   an XML generator and comparator. If so, it should be easier to
   convert results to web representations for display.

   A testcase array ("test/testcase.ml") drives unit testing.
   It defines expected results as an option structure, so None
   is an option that returns success.

   Unit testing rewrites the testcase array to a side output file
   ("test/data/cases.out"). This file has all cases and their results,
   by writing out expected results as a Some value.  If all tests
   succeed, one can replace the testcase array with the side output
   file.
*)

type section_hashtbl = (string, (string * string) Stack.t) Hashtbl.t

type section_name_hashtbl = (string * string, string) Hashtbl.t

type trec = { ht_sect : section_hashtbl; ht : section_name_hashtbl; }

type t = trec
(* sslconf type *)

let create () =
  <span data-count="74">l</span>et ht_sect = <span data-count="74">H</span>ashtbl.create ~random:false 10 in
  <span data-count="74">l</span>et ht = <span data-count="74">H</span>ashtbl.create ~random:false 10 in
  <span data-count="74">l</span>et stack = <span data-count="74">S</span>tack.create () in
  <span data-count="74">l</span>et section = <span data-count="74">"</span>default" in
  <span data-count="74">H</span>ashtbl.add ht_sect section stack;
  <span data-count="74">{</span> ht_sect; ht }

(* call here only with a section+name hash table ! *)
let find_option_section_name ht section_name = 
  <span data-count="28">t</span>ry Some (Hashtbl.find ht section_name) with <span data-count="21">N</span>ot_found -&gt; None

(* get value for name in default section *)
let get_default_value ht name =
  <span data-count="7">f</span>ind_option_section_name ht ("default", name)

(* get value for name in process environment *)
let get_env_value name =
  <span data-count="14">t</span>ry Some (Sys.getenv name) with <span data-count="3">N</span>ot_found -&gt; None

(* call here only with an optional section+name hash table ! *)
let get_string ?ht ?section name =
  <span data-count="24">m</span>atch ht with
  | <span data-count="22">S</span>ome ht -&gt; (
      match section with
      | <span data-count="21">S</span>ome section -&gt; (
          match find_option_section_name ht (section, name) with
          | <span data-count="5">S</span>ome value -&gt; Some value
          | <span data-count="16">N</span>one -&gt;
            if section = "ENV"
            then
              <span data-count="12">m</span>atch get_env_value name with
              | <span data-count="10">S</span>ome value -&gt; Some value
              | <span data-count="2">N</span>one -&gt; get_default_value ht name
            else
              <span data-count="4">g</span>et_default_value ht name
        )
      | <span data-count="1">N</span>one -&gt; get_default_value ht name
    )
  | <span data-count="2">N</span>one -&gt; get_env_value name

(* call here only with an optional section+name hash table ! *)
let conf_get_string ?conf ?section name =
  <span data-count="7">m</span>atch conf with
  | <span data-count="5">S</span>ome conf -&gt; get_string ~ht:conf.ht ?section name
  | <span data-count="2">N</span>one -&gt; get_string ?section name

(* call here only with a section hash table ! *)
let get_section ht section = 
  <span data-count="84">t</span>ry Some (Hashtbl.find ht section) with <span data-count="2">N</span>ot_found -&gt; None

let conf_get_section conf section =
  <span data-count="2">g</span>et_section conf.ht_sect section

(* maximum string length returned by {!Buf.gets}. (Openssl CONFBUFSIZE) *)
let max_length = <span data-count="2">5</span>10 (* CONFBUFSIZE = 512 for C strings ending in '\0' *)

(* i/o buffer size in bits - we allow lower than default for test support *)
let default_nbits = <span data-count="2">3</span>1
and nbits = <span data-count="2">r</span>ef None

(* a line inside parse_line can contain multiple external lines. *)
type continued_line = string * int list

(* returned by [getline] *)
type line =
    Line of continued_line
  | EOF

(** [getline ic] converts reads into a line for the parser.
  A result structure is returned.  If ok, an {!line} is returned.
  If error, the following is returned:
   * a message string;
   * the [nbits] of the buffer;
   * the length requested for a next read; and
   * the buffer memory max size limit.

  If an error is returned, it should be the error result of a call
  to extend the buffer. The memory allocation request would be 4/3
  times the requested length.

  [getline] handles:
   * I/O getting,
   * buffering,
   * buffer extending, and
   * continuation character handling.

  Returns a continued line and a list of offsets.
  The list shows where (at which offsets) next lines were appended.

  Logic here follows openssl code, except see note in code.

  Detail:

  A line for the parser can hold multiple lines from the channel.

  One hopes a piece (a block or a subblock) is a line from a channel.
  Almost always, it will be -- but it could be less.
  "Pieces" are assembled by char reads, until
   * a newline is found;
   * EOF is detected; or
   * a max length is read.

  Characters read are put in a buffer.
  The buffer is pre-extended so it can always hold a next piece.
  Buffer memory allocation is bounded by a max {!nbits} bit length.

  A piece may end with a line continuation.  A {e line continuation}
  is an escape character at the end of a piece (or just before,
  if the end is a newline). The special meaning of this character is
  nullified if an escape char is found just before it.

  {v This is \
a line with \
two line continuations. v}

   {v This is \
a line with two line continuations,\
ending with an escape char. \\ v}

  Ends of pieces, i.e., line continuations and newlines, are stripped.

  {v This was a line with two line continuations. v}

  {v This was a line with two line continuations, ending with an escape char. \\ v}

  The buffer concatenates
   * a first piece read;}
   * further pieces, if line continuations were found; and}
   * further pieces, if a piece is max length and has no newline.}}
  Relative offsets of pieces which follow any newlines read
  are saved as a list of integers.  This list is used by the parser for
  line and column number error reporting.
 *)
let getline ic =

  (* [loop ic buf starts start]
     - ic : input channel
     - buf : line buffer ([!nbits] max length)
     - starts : offsets in line buffer of lines from file
     - start : offset in line buffer of next line

     return continued_line * start_offsets
   *)
  <span data-count="216">l</span>et rec loop ic buf starts start =
    <span data-count="232">m</span>atch Buf.extend buf (start + max_length) with
    | <span data-count="229">O</span>k buf -&gt;
      let data = <span data-count="229">B</span>uf.data buf in
      <span data-count="229">l</span>et n = <span data-count="229">B</span>io.gets ic data start max_length in
      (*
         - debug output
      if n = max_length &amp;&amp; start = 0
      then
        let last_ch = Bytes.get data (start + n - 1) in
        if last_ch != '\n'
        then
          let next_last_ch = Bytes.get data (start + n - 2) in
          Printf.printf
            "max_length = %d; last_ch = '%c'; next_last_ch = '%c'\n"
            max_length last_ch next_last_ch
        else ()
      else ();
       *)
      <span data-count="229">i</span>f <span data-count="229">s</span>tart = 0 &amp;&amp; <span data-count="215">n</span> = 0
      then <span data-count="53">O</span>k EOF (* empty buffer and no newline seen === end of file *)
      else
        (* Strip continuation character and newline (LF or CRLF).
           Here, we are simpler than NCONF code.
           In NCONF code, newline stripping is recursive.
           I guess a line with \\\n\\\n\\\n could end up as one line.
           That can't happen for us.
           Our "get" ([Bio.gets]) reads zero or one newline.
        *)
        <span data-count="176">l</span>et line_length =
          <span data-count="176">i</span>f n = 0
          then <span data-count="2">n</span>
          else <span data-count="174">i</span>f Bytes.get data (start + n - 1) = '\n'
          then
            <span data-count="154">l</span>et strip_n =
              <span data-count="154">i</span>f <span data-count="154">n</span> &gt; 1 &amp;&amp; <span data-count="145">B</span>ytes.get data (start + n - 2) = '\r'
              then <span data-count="3">2</span>
              else <span data-count="151">1</span>
            in <span data-count="154">n</span> - strip_n
          else <span data-count="20">n</span>
        in
        (* end of line was seen *)
        <span data-count="176">l</span>et eol_seen = <span data-count="176">l</span>ine_length != n in
        (* a long line is a full read with no newline at its end *)
        <span data-count="176">l</span>et long_line = <span data-count="176">n</span> = max_length &amp;&amp; <span data-count="8">n</span>ot eol_seen in
        (* seek start of next line *)
        <span data-count="176">l</span>et start = <span data-count="176">s</span>tart + line_length in
          (*
             Q: is an unescaped escape char at end of line?
             Then it's a continuation character.
             But what if the line is long, so we're not at end of line?
             NCONF code still detects a continuation character.
             In context of NCONF parsing, this isn't a harmful thing.
             So I'll allow it ... but it seems like a bug ...
           *)
        <span data-count="176">l</span>et line_cont_seen =
          <span data-count="176">s</span>tart != 0
          &amp;&amp; <span data-count="167">B</span>ytes.get data (start - 1) = '\\'
          &amp;&amp; <span data-count="12">(</span><span data-count="12">s</span>tart = 1 || <span data-count="12">n</span>ot (Bytes.get data (start - 2) = '\\')) in
        <span data-count="176">l</span>et start = <span data-count="176">i</span>f line_cont_seen then <span data-count="11">s</span>tart - 1 else <span data-count="165">s</span>tart in
        (* if line continuation was seen, drop continuation char *)
        <span data-count="176">i</span>f <span data-count="176">l</span>ong_line || <span data-count="168">l</span>ine_cont_seen
        then
          <span data-count="16">l</span>et starts = <span data-count="16">i</span>f eol_seen then <span data-count="6">s</span>tart :: starts else <span data-count="10">s</span>tarts in
          (* if saw end of line, add start offset to line offsets *)
          <span data-count="16">l</span>oop ic buf starts start
        else
          <span data-count="160">l</span>et line = <span data-count="160">B</span>ytes.sub_string data 0 start
          and starts = <span data-count="160">L</span>ist.rev starts in
          <span data-count="160">O</span>k (Line (line, starts))
    | <span data-count="3">E</span>rror tuple -&gt; Error tuple
  in
  <span data-count="216">l</span>et nbits = <span data-count="216">m</span>atch !nbits with <span data-count="207">N</span>one -&gt; default_nbits | <span data-count="9">S</span>ome i -&gt; i in
  <span data-count="216">l</span>et buf = <span data-count="216">B</span>uf.empty nbits in
  <span data-count="216">l</span>oop ic buf [] 0

open Astring

(*
   use cases: parse_dquote (2 times), parse_quote (3 times).
   side effect: a new base string is created.
 *)
let finish_parse_loop acc data rem =
  <span data-count="190">l</span>et open String.Sub in
  let acc = <span data-count="190">L</span>ist.rev (data :: acc) in
  <span data-count="190">c</span>oncat
    acc (* new base string *)
, rem

(* used in Win32 *)
(* allow everything, double quotes escape double quotes, strip wrappers. *)
let parse_dquote s = (*BISECT-IGNORE-BEGIN*)
  let rec loop acc s =
    let open String.Sub in
    let is_data = function '"' -&gt; false | _ -&gt; true in
    (* all but quotes *)
    let data, rem = span ~sat:is_data s in
    match head rem with
    | Some '"' -&gt; (
        let rem = tail rem in
        match head rem with
        | Some '"' -&gt; (* double quotes escape double quotes *)
          let data = extend ~max:1 data in
          loop (data :: acc) (tail rem)
        | Some _ | None -&gt;
          finish_parse_loop acc data rem
      )
    | Some _ -&gt; failwith "parse_dquote: pattern-match failure" (*BISECT-IGNORE*)
    | None -&gt; finish_parse_loop acc data rem (* accept if eol *)
  in
  loop [] s (*BISECT-IGNORE-END*)

(* used in Unix and Cygwin *)
(* allow everything, use '\\' to escape any next character. *)
let parse_quote q s =
  <span data-count="7">l</span>et is_data c = <span data-count="24">c</span> != q &amp;&amp; <span data-count="19">c</span> != '\\' in
  <span data-count="7">l</span>et rec loop acc s =
    <span data-count="9">l</span>et open String.Sub in
    (* all but quotes and escape chars *)
    let data, rem = <span data-count="9">s</span>pan ~sat:is_data s in
    <span data-count="9">m</span>atch head rem with
    | <span data-count="5">S</span>ome c when <span data-count="7">c</span> = q -&gt; finish_parse_loop acc data (tail rem)
    | <span data-count="2">S</span>ome '\\' -&gt; (
        let rem = <span data-count="2">t</span>ail rem in (* skip past escape char *)
        <span data-count="2">m</span>atch head rem with
        | <span data-count="2">S</span>ome c -&gt; loop ((of_char c) :: data :: acc) (tail rem)
        | None -&gt; finish_parse_loop acc data rem (*BISECT-IGNORE*)
        (* None case excluded by call context
           -- always a char next, or char is continuation char at eol.
        *)
      )
    | Some _ -&gt; failwith "parse_quote: pattern-match failure" (*BISECT-IGNORE*)
    | <span data-count="2">N</span>one -&gt; finish_parse_loop acc data rem (* accept if eol *)
  in
  <span data-count="7">l</span>oop [] s

(*
   use cases: parse_name (2 times), parse_line (1 time).
   span, include escaped characters, don't exclude escape chars.
 *)
let span_with_escapes sat rem =
  <span data-count="183">l</span>et open String.Sub in
  let rec loop acc rem =
    <span data-count="200">l</span>et data, rem = <span data-count="200">s</span>pan ~sat rem in
    <span data-count="200">m</span>atch head rem with
    | <span data-count="17">S</span>ome '\\' -&gt; (
        let rem = <span data-count="17">t</span>ail rem in
        <span data-count="17">m</span>atch head rem with
        | <span data-count="17">S</span>ome _ -&gt;
          let data = <span data-count="17">e</span>xtend ~max:2 data in
          <span data-count="17">l</span>oop (data :: acc) (tail rem)
        | None -&gt;                             (*BISECT-IGNORE*)
          let data = extend ~max:1 data in   (*BISECT-IGNORE*)
          finish_parse_loop acc data rem     (*BISECT-IGNORE*)
          (* case excluded by call context
             -- always a char next, or char is continuation char at eol.
          *)
      )
    | <span data-count="165">S</span>ome _ | <span data-count="18">N</span>one -&gt;
      finish_parse_loop acc data rem
  in
  <span data-count="183">l</span>oop [] rem

(*
   use cases: subst (1 time, is_an), parse_line (1 time, is_anp).
   parse a qualified or unqualified name, with different predicates
 *)
let parse_name sat rem =
  <span data-count="118">l</span>et open String.Sub in
  let part, rem = <span data-count="118">s</span>pan_with_escapes sat rem in
  <span data-count="118">m</span>atch head rem with
  | <span data-count="19">S</span>ome ':' -&gt; (
      let rem = <span data-count="19">t</span>ail rem in
      <span data-count="19">m</span>atch head rem with
      | <span data-count="16">S</span>ome ':' -&gt;
        let section = <span data-count="16">t</span>o_string part in
        <span data-count="16">l</span>et name, rem = <span data-count="16">s</span>pan_with_escapes sat (tail rem) in
        <span data-count="16">O</span>k (Some section, name, rem)
      | <span data-count="2">S</span>ome _ | <span data-count="1">N</span>one -&gt;
        Error (start_pos rem, "parse_name", "two-colon token not found")
    )
  | <span data-count="94">S</span>ome _ | <span data-count="5">N</span>one -&gt; Ok (None, part, rem)

(* substitute [Sslconf.get_string] result *)
let subst ht section rem =
  <span data-count="22">l</span>et open String.Sub in
  (* look for a wrapper *)
  let wrap, rem =
    <span data-count="22">m</span>atch head rem with
    | <span data-count="5">S</span>ome '{' -&gt; Some '}', tail rem
    | <span data-count="3">S</span>ome '(' -&gt; Some ')', tail rem
    | <span data-count="14">_</span> -&gt; None, rem
  in
  <span data-count="22">l</span>et is_an c = <span data-count="156">C</span>har.Ascii.is_alphanum c || <span data-count="19">c</span> = '_' in
  <span data-count="22">m</span>atch parse_name is_an rem with (* no punctuation! no whitespace! *)
  | <span data-count="21">O</span>k (psection, name, rem) -&gt; (
      let result =
        <span data-count="21">m</span>atch wrap with
        | <span data-count="7">S</span>ome c -&gt; (
            match head rem with
            | <span data-count="5">S</span>ome ch -&gt;
              if ch = c
              then <span data-count="3">O</span>k (tail rem) (* don't include closing brace *)
              else <span data-count="2">E</span>rror "missing closing wrap char"
            | <span data-count="2">N</span>one -&gt; Error "missing closing wrap char"
          )
        | <span data-count="14">N</span>one -&gt; Ok rem
      in
      <span data-count="21">m</span>atch result with
      | <span data-count="17">O</span>k rem -&gt; (
          let section = <span data-count="17">m</span>atch psection with
          | <span data-count="13">S</span>ome s -&gt; Some s
          | <span data-count="4">N</span>one -&gt; section
          in
          <span data-count="17">m</span>atch get_string ~ht ?section (to_string name) with
          | <span data-count="14">S</span>ome s -&gt; Ok (String.sub s, rem)
          | <span data-count="3">N</span>one -&gt; Error (start_pos rem, "subst", "variable has no value")
        )
      | <span data-count="4">E</span>rror s -&gt; Error (start_pos rem, "subst", s)
    )
  | <span data-count="1">E</span>rror tuple -&gt; Error tuple

(* translate if special whitespace char *)
let translate_char = <span data-count="2">f</span>unction
| <span data-count="1">'</span>r' -&gt; '\r' (* carriage return *)
| <span data-count="1">'</span>n' -&gt; '\n' (* newline *)
| <span data-count="1">'</span>b' -&gt; '\b' (* backspace *)
| <span data-count="1">'</span>t' -&gt; '\t' (* tab *)
| <span data-count="9">c</span> -&gt; c

(*
   see [str_copy] in Openssl [conf_def.c].
   use cases: parse_line (2 times).
   note: 1st use case (section line) may have escape chars,
         but no other special chars are in play.
   note: section is optional, so is None in 1st use case.
 *)
let parse_value ht section value =
  (* not escape char, double quote, single quote, dollar sign, hash char *)
  <span data-count="136">l</span>et is_data = <span data-count="136">f</span>unction <span data-count="13">'</span>\\' | <span data-count="5">'</span>"' | <span data-count="2">'</span>\'' | <span data-count="22">'</span>$' | <span data-count="3">'</span>#' -&gt; false | <span data-count="405">_</span> -&gt; true in
  <span data-count="136">l</span>et rec loop acc s =
    <span data-count="170">l</span>et open String.Sub in
    let data, rem = <span data-count="170">s</span>pan ~sat:is_data s in
    <span data-count="170">m</span>atch head rem with
    | Some (<span data-count="2">'</span>\'' | <span data-count="5">'</span>"' as quote) -&gt; (
        let f =
          <span data-count="7">i</span>f Sys.os_type = "Win32" (* Unix bisect can't go here *)
          then (if quote = '"' then Some parse_dquote else None) (*BISECT-IGNORE*)
          else <span data-count="7">S</span>ome (parse_quote quote) in
        <span data-count="7">m</span>atch f with
        | <span data-count="7">S</span>ome f -&gt;
            let quoted, rem = <span data-count="7">f</span> (tail rem) in
            <span data-count="7">l</span>oop (quoted :: data :: acc) rem
        | None -&gt; (*BISECT-IGNORE*)
            loop ((of_char quote) :: acc) (tail rem)
            (* bisect under Unix will not go here *)
      )
    | <span data-count="13">S</span>ome '\\' -&gt; (
        let rem = <span data-count="13">t</span>ail rem in
        <span data-count="13">l</span>et acc = <span data-count="13">d</span>ata :: acc in
        <span data-count="13">m</span>atch head rem with
        | <span data-count="13">S</span>ome c -&gt; loop ((of_char (translate_char c)) :: acc) (tail rem)
        | None -&gt; loop acc rem (*BISECT-IGNORE*)
        (* None case excluded by call context
           -- always a char next, or char is continuation char at eol.
        *)
      )
    | <span data-count="22">S</span>ome '$' -&gt; (
        (* variable substitution *)
        match subst ht section (tail rem) with
        | <span data-count="14">O</span>k (value, rem) -&gt; loop (value :: data :: acc) rem
        | <span data-count="8">E</span>rror tuple -&gt; Error tuple
      )
    | <span data-count="3">S</span>ome '#' | <span data-count="125">N</span>one -&gt;
      let acc = <span data-count="128">L</span>ist.rev (data :: acc) in
      <span data-count="128">O</span>k (drop ~rev:true ~sat:Char.Ascii.is_white (concat acc)) (* trim trailing space *)
    | Some _ -&gt; failwith "parse_value: pattern-match failure" (*BISECT-IGNORE*)
  in
  <span data-count="136">l</span>oop [] value

(* note - no special characters are here at all *)
let is_punct = <span data-count="2">f</span>unction
  <span data-count="4">'</span>!' | <span data-count="4">'</span>.' | <span data-count="1">'</span>%' | <span data-count="1">'</span>&amp;' | <span data-count="1">'</span>*' | <span data-count="1">'</span>+' |
  <span data-count="2">'</span>;' | <span data-count="1">'</span>?' | <span data-count="1">'</span>@' | <span data-count="1">'</span>^' | <span data-count="1">'</span>~' | <span data-count="1">'</span>|' | <span data-count="1">'</span>-' -&gt; true
| <span data-count="163">_</span> -&gt; false

(* see openssl crypto/conf/conf_def.c; section changes if ['['..']'] seen.

   [parse_line hts ht section line] parses a line.
   [section] is a default section.
   A result structure is returned.
   Ok returns a state to pass to the next [parse_line] call:
   {ul {- a default section;}
       {- a {!section_hashtbl}; and}
       {- a {!section_name_hashtbl}.}}
   Error returns:
   {ul {- a position offset in the string;}
       {- a procedure name; and}
       {- an error message.}}
   The position offset and procedure name show where an error was found.
 *)
let parse_line ht_section ht section line =
  <span data-count="160">l</span>et is_anp c = <span data-count="604">C</span>har.Ascii.is_alphanum c || <span data-count="186">c</span> = '_' || <span data-count="183">i</span>s_punct c in
  <span data-count="160">l</span>et is_anp_or_ws c = <span data-count="362">C</span>har.Ascii.is_white c || <span data-count="362">i</span>s_anp c in
  <span data-count="160">l</span>et line = <span data-count="160">S</span>tring.sub line in
  <span data-count="160">l</span>et open String.Sub in
  let line = <span data-count="160">d</span>rop ~sat:Char.Ascii.is_white line in
  <span data-count="160">m</span>atch head line with
  | <span data-count="1">S</span>ome '#' | <span data-count="14">N</span>one -&gt; Ok (section, ht_section, ht) (* comment *)
  | <span data-count="49">S</span>ome '[' -&gt; (
      let start = <span data-count="49">d</span>rop ~sat:Char.Ascii.is_white (tail line) in
      <span data-count="49">l</span>et name, rem = <span data-count="49">s</span>pan_with_escapes is_anp_or_ws start in
      <span data-count="49">m</span>atch head rem with
      | <span data-count="46">S</span>ome ']' -&gt; (
          match parse_value ht None name with
          | <span data-count="46">O</span>k value -&gt; (
              let section = <span data-count="46">t</span>o_string value in
              <span data-count="46">l</span>et _ =
                <span data-count="46">t</span>ry ignore (Hashtbl.find ht_section section)
                with <span data-count="46">N</span>ot_found -&gt;
                  let stack = <span data-count="46">S</span>tack.create () in
                  <span data-count="46">H</span>ashtbl.add ht_section section stack
              in
              <span data-count="46">O</span>k (section, ht_section, ht)
            )
          | Error tuple -&gt; Error tuple (*BISECT-IGNORE*)
          (* [caller context] parse_value can't return Error here *)
        )
      | <span data-count="2">S</span>ome _ | <span data-count="1">N</span>one -&gt;
        Error (start_pos rem, "parse_line", "closing square bracket not found")
    )
  | <span data-count="96">S</span>ome c -&gt; (
      if Sys.os_type = "Win32" &amp;&amp; c == ';' (*BISECT-IGNORE*)
      then Ok (section, ht_section, ht) (*BISECT-IGNORE*)
           (* Unix bisect can't go here *)
      else <span data-count="96">m</span>atch parse_name is_anp line with
      | <span data-count="94">O</span>k (psection, name, rem) -&gt; (
          let section = <span data-count="94">m</span>atch psection with <span data-count="3">S</span>ome s -&gt; s | <span data-count="91">N</span>one -&gt; section
          and rem = <span data-count="94">d</span>rop ~sat:Char.Ascii.is_white rem in
          <span data-count="94">m</span>atch head rem with
          | <span data-count="90">S</span>ome '=' -&gt; (
              let rem = <span data-count="90">t</span>ail rem in
              <span data-count="90">l</span>et value = <span data-count="90">d</span>rop ~sat:Char.Ascii.is_white rem in
              <span data-count="90">m</span>atch parse_value ht (Some section) value with
              | <span data-count="82">O</span>k value -&gt; (
                  let name = <span data-count="82">t</span>o_string name and value = <span data-count="82">t</span>o_string value in
                  <span data-count="82">l</span>et v = <span data-count="82">(</span>name, value) in
                  <span data-count="82">b</span>egin
                    match (get_section ht_section section) with
                    | <span data-count="81">S</span>ome stack -&gt; Stack.push v stack
                    | <span data-count="1">N</span>one -&gt; (
                        let stack = <span data-count="1">S</span>tack.create () in
                        <span data-count="1">S</span>tack.push v stack;
                        <span data-count="1">H</span>ashtbl.add ht_section section stack
                      );
                  end;
                  <span data-count="82">H</span>ashtbl.add ht (section, name) value;
                  <span data-count="82">O</span>k (section, ht_section, ht)
                )
              | <span data-count="8">E</span>rror tuple -&gt; Error tuple
            )
          | <span data-count="3">S</span>ome _ | <span data-count="1">N</span>one -&gt;
            Error (start_pos rem, "parse_line", "equal sign not found")
        )
      | <span data-count="2">E</span>rror tuple -&gt; Error tuple
    )

(*
   used only in parse_file.
   identify which original line and column contains a pos.
 *)
let find_pos starts pos =
  <span data-count="17">l</span>et rec loop i a starts pos =
    <span data-count="19">m</span>atch starts with
    | <span data-count="3">b</span> :: starts -&gt;
      if pos &gt;= b
      then <span data-count="2">l</span>oop (i + 1) b starts pos
      else <span data-count="1">i</span>, pos - a
    | <span data-count="16">[</span>] -&gt; i, pos - a
  in
  <span data-count="17">l</span>oop 0 0 starts pos

type error =
  | Open of string
  | Extend of string * int * int * int
  | Parse of string * int * int * string * string

(* return a user-friendly string summarizing an error. *)
let error_to_string error =
  <span data-count="21">m</span>atch error with
  | <span data-count="1">O</span>pen s -&gt; s
  | <span data-count="3">E</span>xtend (s, nbits, len, limit) -&gt;
    Printf.sprintf "%s: nbits=%d,len=%d,limit=%d" s nbits len limit
  | <span data-count="17">P</span>arse (filename, lineno, pos, fname, msg) -&gt;
    Printf.sprintf
      "%s|line %d col %d|[module Sslconf function %s]: %s"
      filename lineno pos fname msg

(* error report precision wrangling, mostly *)
let conf_load_file conf filename =
  <span data-count="74">m</span>atch (try Ok (open_in filename) with <span data-count="1">S</span>ys_error s -&gt; Error s) with
  | <span data-count="1">E</span>rror s -&gt; Error (Open s)
  | <span data-count="73">O</span>k ic -&gt;
    let rec loop lineno section ht_sect ht ic =
      (* line handler *)
      <span data-count="216">m</span>atch getline ic with
      | <span data-count="160">O</span>k (Line (line, ranges)) -&gt; (
          (* line parser *)
          match parse_line ht_sect ht section line with
          | <span data-count="143">O</span>k (section, ht_sect, ht) -&gt;
            (* update line number for error reporting *)
            let lineno = <span data-count="143">l</span>ineno + (List.length ranges) + 1 in
            <span data-count="143">l</span>oop lineno section ht_sect ht ic
          | <span data-count="17">E</span>rror (pos, fname, msg) -&gt;
            let i, pos = <span data-count="17">f</span>ind_pos ranges pos in
            <span data-count="17">E</span>rror (Parse (filename, lineno + i, pos, fname, msg))
        )
      | <span data-count="53">O</span>k EOF -&gt; Ok ()
      | <span data-count="3">E</span>rror (s, nbits, len, limit) -&gt; Error (Extend (s, nbits, len, limit))
    in
    <span data-count="73">l</span>et res = <span data-count="73">l</span>oop 1 "default" conf.ht_sect conf.ht ic in
    <span data-count="73">c</span>lose_in ic;
    <span data-count="73">r</span>es

open Sexplib
open Sexplib.Std

(* conversion to / from sexp *)

type string_pair = string * string [@@deriving sexp]
type spl = string_pair list [@@deriving sexp]
type hkv = string_pair * string [@@deriving sexp]
type hkvl = hkv list [@@deriving sexp]
type hskv = string * spl [@@deriving sexp]
type hskvl = hskv list [@@deriving sexp]
type hs_h = hskvl * hkvl [@@deriving sexp]

let hfold h = <span data-count="44">l</span>et f k v l = <span data-count="52">(</span>k, v) :: l in <span data-count="44">H</span>ashtbl.fold f h []
and sfold stk = <span data-count="75">l</span>et f l e = <span data-count="54">e</span> :: l in <span data-count="75">S</span>tack.fold f [] stk
let hsfold h = <span data-count="44">l</span>et f k v l = <span data-count="74">(</span>k, sfold v) :: l in <span data-count="44">H</span>ashtbl.fold f h []
let htfold (hs, h) = <span data-count="44">h</span>sfold hs, hfold h

let hunfold l =
  <span data-count="0">l</span>et h = <span data-count="0">H</span>ashtbl.create ~random:false 10 in
  <span data-count="0">l</span>et f (k, v) = <span data-count="0">H</span>ashtbl.add h k v in
  <span data-count="0">L</span>ist.iter f l;
  <span data-count="0">h</span>
and sunfold kvl =
  <span data-count="0">l</span>et stack = <span data-count="0">S</span>tack.create () in
  <span data-count="0">l</span>et f kv = <span data-count="0">S</span>tack.push kv stack in
  <span data-count="0">L</span>ist.iter f kvl;
  <span data-count="0">s</span>tack
let hsunfold l =
  <span data-count="0">l</span>et h = <span data-count="0">H</span>ashtbl.create ~random:false 10 in
  <span data-count="0">l</span>et f (k, kvl) = <span data-count="0">H</span>ashtbl.add h k (sunfold kvl) in
  <span data-count="0">L</span>ist.iter f l;
  <span data-count="0">h</span>
let htunfold (hsl, hl) = <span data-count="0">h</span>sunfold hsl, hunfold hl

type section_stack = (string * string) Stack.t

let sexp_of_stack stack = <span data-count="1">s</span>fold stack |&gt; <span data-count="1">s</span>exp_of_spl
let stack_of_sexp sexp = <span data-count="0">s</span>pl_of_sexp sexp |&gt; <span data-count="0">s</span>unfold

let sexp_of_conf conf = <span data-count="44">h</span>tfold (conf.ht_sect, conf.ht) |&gt; <span data-count="44">s</span>exp_of_hs_h
let conf_of_sexp sexp =
  <span data-count="0">l</span>et hs_h = <span data-count="0">h</span>s_h_of_sexp sexp in
  <span data-count="0">m</span>atch htunfold hs_h with <span data-count="0">(</span>ht_sect, ht) -&gt; { ht_sect; ht; }

(*---------------------------------------------------------------------------
   Copyright (c) 2017 Tony Wuersch

   Permission to use, copy, modify, and/or distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.

   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  ---------------------------------------------------------------------------*)
</pre>
      </div>
    </div>
    <div id="footer">Generated on 2017-10-07 00:09:52 by <a href="https://github.com/aantron/bisect_ppx">Bisect_ppx</a> 1.3.0</div>
    <script src="coverage.js"></script>
  </body>
</html>
